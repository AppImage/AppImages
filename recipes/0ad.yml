app: 0ad

ingredients:
  dist: trusty
  sources:
    - deb https://mirrors.aliyun.com/ubuntu/ trusty main universe
  ppas:
    - wfg/0ad


script:
  - find usr/lib/games/0ad/ -type f -iname '*.so.*' -exec mv {} usr/lib/ \;
  - mv usr/games/* usr/bin/
  - mkdir -p usr/bin/share
  - mv usr/share/games usr/bin/share
  - sed -i -e 's#/usr#././#g' usr/bin/pyrogenesis
  - rm usr/bin/0ad
  - cat > usr/bin/0ad <<EOF
  - #!/bin/sh
  - HERE=\$(cd "\$(dirname "\$0")";pwd)
  - cd "$HERE"
  - pyrogenesis=\$(which pyrogenesis 2> /dev/null)
  - if [ -x "\$pyrogenesis" ] ; then
  -  "\$pyrogenesis" "\$@"
  - else
  -  echo "Error: pyrogenesis not found in (\$PATH)"
  -  exit 1
  - fi
  - EOF
  - chmod +x 0ad
